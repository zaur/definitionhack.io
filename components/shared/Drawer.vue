<template>
  <div class='drawer'>
    <div ref='drawer' />
  </div>
</template>

<script>
import { FourierDiagram } from '@/libs/fourier-polygon'

export default {
  props: {
    accuracy: { type: [Number, String], required: true }
  },

  data: () => ({
    path: [[1021.5,582.4],[1013.7515625,551.3203125],[999.3375,533.9375],[979.2,524.7],[951.3828125,504.06875],[934.9375,465.7],[925.1,412.1],[904.7375,297.15],[891.8,268.0],[865.853125,242.19375],[828.075,222.275],[779.2,204.9],[719.75,190.5],[684.6,189.6],[558.5,185.1],[433.3,191.6],[399.4375,184.8625],[391.9,176.1],[424.3,181.3875],[432.4,177.9],[411.3,172.5],[366.525,150.7875],[334.2,141.9],[355.4625,137.2875],[361.2,132.0],[325.6125,132.3],[293.7,123.6],[320.7,113.1],[300.0828125,116.728125],[276.6625,112.425],[249.5,102.3],[272.9,97.8],[239.7375,88.7375],[216.7,89.8],[225.3375,83.7875],[230.6,85.2],[209.446875,78.06875],[187.675,79.15],[163.8,86.0],[151.225,81.5625],[122.0,82.3],[129.8875,85.1125],[135.3,96.1],[113.8625,91.1125],[96.7828125,93.5265625],[84.1,106.9],[92.45,104.425],[100.8,116.8],[89.4125,119.6375],[73.0,139.5],[85.2,134.5],[62.675,151.5625],[38.5,184.9],[45.0375,177.5],[64.1,170.1],[58.1375,178.15],[53.0,198.8],[48.6,218.6],[19.7,259.2],[9.55,275.2875],[3.6,298.8],[14.2,307.7],[18.9375,318.725],[35.3,331.7],[38.5,343.65],[60.9,357.1],[55.3,351.9],[75.3,352.2],[66.9,349.7],[85.8,336.3],[95.4125,335.7],[107.5,326.7],[119.325,347.825],[125.3,380.8],[132.0,360.0],[137.4,376.7],[135.3,404.5],[147.5,379.8],[151.9875,402.5875],[150.4,432.8],[163.0,412.1],[166.0375,427.85],[179.2,451.7],[179.2,438.2],[187.3,458.9],[194.5,446.3],[170.2,533.7],[147.7,596.8],[138.7,613.9],[120.7,637.4],[107.2,634.9875],[94.88125,638.4546875],[82.9,650.8],[79.525,656.9875],[85.6,659.8],[89.875,667.3375],[111.7,671.5],[146.8,672.3],[156.7,665.7125],[169.3,643.6],[183.7,629.2],[188.0875,630.4375],[194.5,614.8],[233.2,549.9],[251.3125,524.35],[272.8,480.5],[275.95,489.1625],[289.9,503.9],[283.9375,494.9],[285.4,475.1],[284.9875,481.8875],[294.4,495.8],[297.1,464.3],[304.975,478.8125],[306.1,502.1],[314.65,491.625],[323.2,445.3],[330.4,477.7],[337.6,448.9],[343.225,454.6375],[347.5,473.2],[352.9,462.7375],[355.6,443.5],[367.3,487.6],[379.9,536.3],[385.5,572.3],[385.9625,588.6125],[392.5,611.0],[392.8375,629.0],[381.7,649.7],[366.4,653.75],[355.121875,662.609375],[348.4,679.4],[353.8,679.4],[359.65,685.025],[384.4,686.6],[392.6125,690.1375],[423.1,687.9],[431.425,677.525],[438.4,655.0],[438.9625,641.6125],[445.6,628.9],[448.975,624.175],[445.6,601.9],[442.5625,574.4],[447.4,530.7],[447.4,459.5],[457.2,457.0],[450.8,452.0],[469.3,451.3],[456.5,444.2],[475.0,445.6],[460.0,439.2],[508.1984375,442.146875],[546.8625,436.15],[581.9,423.5],[624.8625,398.025],[647.5,388.6],[663.3203125,393.4296875],[675.2125,404.7375],[685.3,421.4],[713.175,468.25],[735.2,488.4],[751.0,527.2],[772.0875,570.2],[775.1,590.4],[764.15,628.1875],[755.9,644.6],[727.4,648.2],[710.725,658.2375],[707.4,666.7],[705.9125,673.325],[708.7,674.1],[723.55,682.9875],[733.0,680.4],[752.9125,685.125],[765.4,683.1],[783.4,670.5],[823.0,608.7],[826.8,651.5],[805.3,668.5],[793.6875,685.6375],[794.3,694.9],[795.85,701.6125],[798.9,700.9],[815.0625,704.6],[820.8,700.5],[857.9,694.1],[867.2125,679.9375],[869.7,668.4],[873.5,582.1],[875.5,559.7],[881.2765625,526.4828125],[877.3125,509.6625],[866.3,502.9],[849.621875,492.871875],[837.5,476.075],[827.6,453.3],[826.1125,431.365625],[833.175,403.0],[846.7,368.0],[862.3375,343.8125],[863.8,325.7],[869.2,305.9],[882.8546875,329.7234375],[892.7125,365.4625],[900.7,412.2],[916.915625,472.15],[938.55,510.05],[965.6,535.6],[972.7859375,567.8890625],[985.9625,589.6875],[1004.3,605.9],[997.8875,590.675],[997.1,578.9],[1008.321875,587.984375],[1011.95,600.95],[1010.6,617.6],[1019.09375,600.45625],[1018.475,583.8],[1011.5,566.2],[1021.5,582.4],[1021.5,582.4]],
    speed: 50,
  }),

  computed: {
    result () {
      return this.path.filter((e, i) => i % Number(this.accuracy) === 0);
    },
  },

  watch: {
    accuracy: {
      handler (val) {
        if (!val || !Number(val)) { return }
        this.draw()
      }
    }
  },

  mounted () {
    this.draw()
  },

  methods: {
    draw () {
      const diagram = new FourierDiagram (this.$refs.drawer, this.result, this.speed);
      diagram.draw()
    }
  }
}
</script>

<style lang='scss'>
@import "~@/styles/system.scss";

.drawer {
  svg {
    max-width: 100%;
    height: auto !important;
  }
}
</style>
